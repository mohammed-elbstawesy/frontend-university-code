<section class="flex flex-col items-center justify-center min-h-screen w-full animate-fade-in px-4 py-10 relative bg-[#0a0a0f]">
    
    <a routerLink="/" class="absolute top-6 left-4 md:left-10 flex items-center text-slate-500 hover:text-white transition-colors cursor-pointer z-10">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg>
        Back to Home
    </a>

    <div class="w-full max-w-3xl bg-[#1c1c2e]/90 border border-slate-800 rounded-2xl p-8 backdrop-blur-xl shadow-2xl relative overflow-hidden mt-12 md:mt-0">
        <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[#00f0ff] via-[#7000ff] to-[#00f0ff]"></div>
        
        <div class="text-center mb-8">
            <h2 class="text-3xl font-bold text-white mb-2">Create Account</h2>
            <p class="text-slate-400 text-sm">Complete your profile to start scanning</p>
        </div>

        <form [formGroup]="signUpForm" (ngSubmit)="onSubmit()" class="space-y-5">
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <div class="w-full">
                    <label class="block text-xs font-medium text-slate-400 mb-1.5 ml-1">First Name</label>
                    <div [className]="'relative flex items-center bg-[#13131f] rounded-lg border transition-all duration-300 ' + getFieldClass('fristName')">
                        <div class="pl-3 text-slate-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                        </div>
                        <input formControlName="fristName" type="text" placeholder="John" class="w-full bg-transparent border-none text-slate-100 placeholder-slate-600 focus:ring-0 py-2.5 pl-3 pr-2 rounded-lg outline-none text-sm">
                    </div>
                    @if (signUpForm.get('fristName')?.invalid && (signUpForm.get('fristName')?.touched || signUpForm.get('fristName')?.dirty)) {
                        <div class="text-[#ff003c] text-[10px] mt-1 ml-1 font-medium animate-pulse">
                            @if (signUpForm.get('fristName')?.errors?.['required']) { Please enter first name }
                            @if (signUpForm.get('fristName')?.errors?.['minlength']) { Name must be at least 2 chars }
                        </div>
                    }
                </div>

                <div class="w-full">
                    <label class="block text-xs font-medium text-slate-400 mb-1.5 ml-1">Last Name</label>
                    <div [className]="'relative flex items-center bg-[#13131f] rounded-lg border transition-all duration-300 ' + getFieldClass('lastName')">
                        <div class="pl-3 text-slate-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                        </div>
                        <input formControlName="lastName" type="text" placeholder="Doe" class="w-full bg-transparent border-none text-slate-100 placeholder-slate-600 focus:ring-0 py-2.5 pl-3 pr-2 rounded-lg outline-none text-sm">
                    </div>
                    @if (signUpForm.get('lastName')?.invalid && (signUpForm.get('lastName')?.touched || signUpForm.get('lastName')?.dirty)) {
                        <div class="text-[#ff003c] text-[10px] mt-1 ml-1 font-medium animate-pulse">
                            @if (signUpForm.get('lastName')?.errors?.['required']) { Please enter last name }
                            @if (signUpForm.get('lastName')?.errors?.['minlength']) { Name must be at least 2 chars }
                        </div>
                    }
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <div class="w-full">
                    <label class="block text-xs font-medium text-slate-400 mb-1.5 ml-1">Email Address</label>
                    <div [className]="'relative flex items-center bg-[#13131f] rounded-lg border transition-all duration-300 ' + getFieldClass('email')">
                        <div class="pl-3 text-slate-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg>
                        </div>
                        <input formControlName="email" type="email" placeholder="name@company.com" class="w-full bg-transparent border-none text-slate-100 placeholder-slate-600 focus:ring-0 py-2.5 pl-3 pr-4 rounded-lg outline-none text-sm">
                    </div>
                    @if (signUpForm.get('email')?.invalid && (signUpForm.get('email')?.touched || signUpForm.get('email')?.dirty)) {
                        <div class="text-[#ff003c] text-[10px] mt-1 ml-1 font-medium animate-pulse">
                            @if (signUpForm.get('email')?.errors?.['required']) { Please enter email address }
                            @if (signUpForm.get('email')?.errors?.['email']) { Please enter a valid email }
                        </div>
                    }
                </div>

                <div class="w-full">
                    <label class="block text-xs font-medium text-slate-400 mb-1.5 ml-1">Phone Number</label>
                    <div [className]="'relative flex items-center bg-[#13131f] rounded-lg border transition-all duration-300 ' + getFieldClass('phone')">
                        <div class="pl-3 text-slate-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                        </div>
                        <input formControlName="phone" type="tel" placeholder="+20 1xxxxxxxxx" class="w-full bg-transparent border-none text-slate-100 placeholder-slate-600 focus:ring-0 py-2.5 pl-3 pr-4 rounded-lg outline-none text-sm">
                    </div>
                    @if (signUpForm.get('phone')?.invalid && (signUpForm.get('phone')?.touched || signUpForm.get('phone')?.dirty)) {
                        <div class="text-[#ff003c] text-[10px] mt-1 ml-1 font-medium animate-pulse">
                            @if (signUpForm.get('phone')?.errors?.['required']) { Please enter phone number }
                            @if (signUpForm.get('phone')?.errors?.['pattern']) { Phone must contain numbers only }
                            @if (signUpForm.get('phone')?.errors?.['minlength']) { Phone number must be at least 7 digits }
                        </div>
                    }
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <div class="w-full">
                    <label class="block text-xs font-medium text-slate-400 mb-1.5 ml-1">Password</label>
                    <div [className]="'relative flex items-center bg-[#13131f] rounded-lg border transition-all duration-300 ' + getFieldClass('password')">
                        
                        <div class="absolute right-3 cursor-pointer z-10 text-slate-500 hover:text-slate-300" (click)="showPassword = !showPassword">
                             @if (showPassword) {
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>
                             } @else {
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                             }
                        </div>

                        <input formControlName="password" [type]="showPassword ? 'text' : 'password'" placeholder="••••••••" class="w-full bg-transparent border-none text-slate-100 placeholder-slate-600 focus:ring-0 py-2.5 pl-3 pr-10 rounded-lg outline-none text-sm">
                    </div>

                    @if (pass?.invalid && (pass?.dirty || pass?.touched))  {
                        <div class="mt-3 p-3 bg-slate-800/50 rounded-lg border border-slate-700/50">
                            <p class="text-[10px] text-slate-400 mb-2 uppercase tracking-wider font-bold">Password Requirements:</p>
                            <ul class="space-y-1">
                                <li class="text-[11px] flex items-center gap-2 transition-colors duration-300" 
                                    [class]="hasMinLength() ? 'text-green-400' : 'text-slate-500'">
                                    <span [class]="hasMinLength() ? 'bg-green-400' : 'bg-slate-600'" class="w-1.5 h-1.5 rounded-full"></span>
                                    At least 8 characters
                                </li>
                                <li class="text-[11px] flex items-center gap-2 transition-colors duration-300"
                                    [class]="hasUpperCase() ? 'text-green-400' : 'text-slate-500'">
                                    <span [class]="hasUpperCase() ? 'bg-green-400' : 'bg-slate-600'" class="w-1.5 h-1.5 rounded-full"></span>
                                    One uppercase letter (A-Z)
                                </li>
                                <li class="text-[11px] flex items-center gap-2 transition-colors duration-300"
                                    [class]="hasLowerCase() ? 'text-green-400' : 'text-slate-500'">
                                    <span [class]="hasLowerCase() ? 'bg-green-400' : 'bg-slate-600'" class="w-1.5 h-1.5 rounded-full"></span>
                                    One lowercase letter (a-z)
                                </li>
                                <li class="text-[11px] flex items-center gap-2 transition-colors duration-300"
                                    [class]="hasNumber() ? 'text-green-400' : 'text-slate-500'">
                                    <span [class]="hasNumber() ? 'bg-green-400' : 'bg-slate-600'" class="w-1.5 h-1.5 rounded-full"></span>
                                    One number (0-9)
                                </li>
                                <li class="text-[11px] flex items-center gap-2 transition-colors duration-300"
                                    [class]="hasSpecial() ? 'text-green-400' : 'text-slate-500'">
                                    <span [class]="hasSpecial() ? 'bg-green-400' : 'bg-slate-600'" class="w-1.5 h-1.5 rounded-full"></span>
                                    One special character (#@$!%*?&)
                                </li>
                            </ul>
                        </div>
                    }
                </div>

                <div class="w-full">
                    <label class="block text-xs font-medium text-slate-400 mb-1.5 ml-1">Confirm Password</label>
                    <div [className]="'relative flex items-center bg-[#13131f] rounded-lg border transition-all duration-300 ' + getFieldClass('rePassword')">
                         
                        <div class="absolute right-3 cursor-pointer z-10 text-slate-500 hover:text-slate-300" (click)="showRePassword = !showRePassword">
                            @if (showRePassword) {
                               <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line></svg>
                            } @else {
                               <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
                            }
                       </div>

                        <input formControlName="rePassword" [type]="showRePassword ? 'text' : 'password'" placeholder="••••••••" class="w-full bg-transparent border-none text-slate-100 placeholder-slate-600 focus:ring-0 py-2.5 pl-3 pr-10 rounded-lg outline-none text-sm">
                    </div>
                    @if (signUpForm.get('rePassword')?.invalid && (signUpForm.get('rePassword')?.touched || signUpForm.get('rePassword')?.dirty)) {
                        <div class="text-[#ff003c] text-[10px] mt-1 ml-1 font-medium animate-pulse">
                            @if (signUpForm.get('rePassword')?.errors?.['required']) { Please confirm your password }
                            @if (signUpForm.get('rePassword')?.errors?.['mismatch']) { Passwords do not match }
                        </div>
                    }
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <div class="w-full">
                    <label class="block text-xs font-medium text-slate-400 mb-1.5 ml-1">Location</label>
                    <div [className]="'relative flex items-center bg-[#13131f] rounded-lg border transition-all duration-300 ' + getFieldClass('location')">
                        <div class="pl-3 text-slate-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                        </div>
                        <input formControlName="location" type="text" placeholder="Cairo, Egypt" class="w-full bg-transparent border-none text-slate-100 placeholder-slate-600 focus:ring-0 py-2.5 pl-3 pr-4 rounded-lg outline-none text-sm">
                    </div>
                    @if (signUpForm.get('location')?.invalid && (signUpForm.get('location')?.touched || signUpForm.get('location')?.dirty)) {
                        <div class="text-[#ff003c] text-[10px] mt-1 ml-1 font-medium animate-pulse">
                            @if (signUpForm.get('location')?.errors?.['required']) { Please enter your location }
                        </div>
                    }
                </div>

                <div class="w-full">
                    <label class="block text-xs font-medium text-slate-400 mb-1.5 ml-1">National ID</label>
                    <div [className]="'relative flex items-center bg-[#13131f] rounded-lg border transition-all duration-300 ' + getFieldClass('nationalID')">
                        <div class="pl-3 text-slate-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="16" rx="2"></rect><line x1="7" y1="8" x2="17" y2="8"></line><line x1="7" y1="12" x2="17" y2="12"></line><line x1="7" y1="16" x2="17" y2="16"></line></svg>
                        </div>
                        <input formControlName="nationalID" type="text" placeholder="14 Digit ID" maxlength="14" class="w-full bg-transparent border-none text-slate-100 placeholder-slate-600 focus:ring-0 py-2.5 pl-3 pr-4 rounded-lg outline-none text-sm">
                    </div>
                    @if (signUpForm.get('nationalID')?.invalid && (signUpForm.get('nationalID')?.touched || signUpForm.get('nationalID')?.dirty)) {
                        <div class="text-[#ff003c] text-[10px] mt-1 ml-1 font-medium animate-pulse">
                            @if (signUpForm.get('nationalID')?.errors?.['required']) { National ID is required }
                            @if (signUpForm.get('nationalID')?.errors?.['minlength'] || signUpForm.get('nationalID')?.errors?.['maxlength']) { ID must be exactly 14 digits }
                        </div>
                    }
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                <div class="w-full">
                    <label class="block text-xs font-medium text-slate-400 mb-1.5 ml-1">Age</label>
                    <div [className]="'relative flex items-center bg-[#13131f] rounded-lg border transition-all duration-300 ' + getFieldClass('age')">
                        <div class="pl-3 text-slate-500">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                        </div>
                        <input formControlName="age" type="number" placeholder="25" min="21" class="w-full bg-transparent border-none text-slate-100 placeholder-slate-600 focus:ring-0 py-2.5 pl-3 pr-4 rounded-lg outline-none text-sm">
                    </div>
                    @if (signUpForm.get('age')?.invalid && (signUpForm.get('age')?.touched || signUpForm.get('age')?.dirty)) {
                        <div class="text-[#ff003c] text-[10px] mt-1 ml-1 font-medium animate-pulse">
                            @if (signUpForm.get('age')?.errors?.['required']) { Please enter your age }
                            @if (signUpForm.get('age')?.errors?.['min']) { You must be at least 21 years old }
                        </div>
                    }
                </div>

                <div class="w-full">
                    <label class="block text-xs font-medium text-slate-400 mb-1.5 ml-1">National ID Image</label>
                    <div [className]="'relative flex items-center bg-[#13131f] rounded-lg border transition-all duration-300 p-1 ' + getFieldClass('image')">
                        <input title="image" type="file" (change)="onFileSelected($event)" accept="image/*" class="w-full text-sm text-slate-400 file:mr-4 file:py-2.5 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-[#00f0ff]/10 file:text-[#00f0ff] hover:file:bg-[#00f0ff]/20 cursor-pointer">
                    </div>
                </div>
            </div>

            <div>
                <div [className]="'w-full border rounded-lg p-4 transition-all ' + getCheckboxClass()">
                    <label class="flex items-start gap-3 cursor-pointer">
                        <input 
                            formControlName="agreement" 
                            type="checkbox" 
                            class="mt-1 w-5 h-5 rounded border-slate-600 text-green-500 focus:ring-green-500 bg-slate-800 cursor-pointer accent-green-500"
                        >
                        <span class="text-xs leading-relaxed transition-colors">
                            <span [className]="'font-bold block mb-1 uppercase tracking-wide ' + (signUpForm.get('agreement')?.value ? 'text-green-500' : 'text-[#ff003c]')">
                                Legal Disclaimer:
                            </span>
                            All scanning operations are under your personal responsibility. In case of any unethical use or illegal activity, your personal data will be handed over to the authorities.
                        </span>
                    </label>
                </div>
                @if (signUpForm.get('agreement')?.invalid && signUpForm.get('agreement')?.touched) {
                    <div class="text-[#ff003c] text-[10px] mt-1 ml-1 font-medium animate-pulse text-center">
                        You must accept the legal disclaimer to continue.
                    </div>
                }
            </div>

            <div class="pt-4">
                <button type="submit" [disabled]="isLoading || signUpForm.invalid" class="relative w-full px-6 py-3.5 rounded-lg font-bold tracking-wide transition-all duration-300 bg-[#00f0ff] text-[#0a0a0f] hover:shadow-[0_0_20px_rgba(0,240,255,0.4)] hover:bg-cyan-300 flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none cursor-pointer">
                    @if (isLoading) {
                        <svg class="animate-spin -ml-1 mr-2 h-5 w-5 text-current" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
                        Creating Account...
                    } @else {
                        Create Account
                    }
                </button>
            </div>
        </form>

        <div class="mt-6 text-center">
            <p class="text-slate-400 text-sm">
                Already have an account? 
                <a routerLink="/login/signin" class="text-[#00f0ff] hover:text-cyan-300 font-medium ml-1 outline-none focus:underline cursor-pointer">
                    Log in
                </a>
            </p>
        </div>
    </div>
</section>